<div class="mainbar-container">
  <header class="header">
    <div class="breadcrumb">
      <button class="menu-toggle-btn" (click)="emitToggleMenu()">
      <img src="/menu.webp" alt="" height="25px" width="25px">
      </button>
      <span class="breadcrumb-head">Orders</span>
    </div>
    <div class="header-actions">
      <div class="brand-shop">
        <span>Bravaa shop</span>
        <img src="/dropdown.png" alt="down" class="dropdown-icon" />
      </div>
      <img src="/notification.webp" alt="bell" width="20px" height="20px" style="cursor: pointer" />
      <div class="user-profile">
        <img src="/profile.webp" alt="User" class="user-avatar" />
      </div>
    </div>
  </header>
  <header class="header">
    <div class="breadcrumb">
      <span class="breadcrumb-item">Home</span>
      <span class="breadcrumb-separator">/</span>
      <span class="breadcrumb-item active">Order</span>
    </div>
  </header>

  <main class="content">
    <div class="page-header">
      <h1 class="page-title">Order Summary</h1>
      <button class="add-product-btn" (click)="openOrderForm()">+ Add Product</button>
    </div>

    <div class="summary-cards">
      <div class="summary-card">
        <h3 class="card-title">Total Order</h3>
        <div class="card-content">
          <span class="card-value">Total {{ totalOrders }}</span>
          <span class="card-period">Last Week</span>
        </div>
      </div>
      <div class="summary-card">
        <h3 class="card-title completed">Completed Order</h3>
        <div class="card-content">
          <span class="card-value">Total {{ completedOrders }}</span>
          <span class="card-period">Last Week</span>
        </div>
      </div>
      <div class="summary-card">
        <h3 class="card-title inprocess">In Process Order</h3>
        <div class="card-content">
          <span class="card-value">Total {{ inProcessOrders }}</span>
          <span class="card-period">Last Week</span>
        </div>
      </div>
    </div>

    <div class="order-items-section">
      <h2 class="section-title">Order Items</h2>

      <div class="table-controls">
        <div class="search-box">
          <span class="search-icon"><img src="search.jpg" alt="search" height="17px" width="17px"></span>
          <input
            type="text"
            placeholder="Search by name..."
            class="search-input"
            [(ngModel)]="searchText"
          />
        </div>
        <div class="table-actions">
          <div class="filter-dropdown-container">
            <button class="filter-btn" (click)="toggleFilterDropdown()">
              <img src="filter.webp" alt="Filter" width="15px" height="15px"/>
              Filter
              <img src="dropdown.png" alt="Filter" width="15px" height="15px"/>
            </button>
            <div class="filter-dropdown" *ngIf="showFilterDropdown">
              <button class="dropdown-item" (click)="sortOrders('total')">
                <span class="dropdown-icon"><img src="dropdown.png" alt="Filter" width="15px" height="15px"/></span>
                Sort by Total
              </button>
              <button class="dropdown-item" (click)="sortOrders('name')">
                <span class="dropdown-icon"><img src="dropdown.png" alt="Filter" width="15px" height="15px"/></span>
                Sort by Name
              </button>
            </div>
          </div>
          <button class="date-btn">
            <img src="date.webp" alt="Date" width="15px" height="15px"/>
            Date</button>
            <button class="export-btn">
            <img src="download.webp" alt="Download" width="15px" height="15px"/>
            Export

          </button>
        </div>
      </div>

      <div class="table-container">
        <table class="data-table">
          <thead>
            <tr>
              <th></th>
              <th>Order</th>
              <th>Customers</th>
              <th>Tracking Id</th>
              <th>Order Date</th>
              <th>Quantity</th>
              <th>Location</th>
              <th>Total</th>
              <th>Status</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let order of filteredOrders; let i = index">
              <td><input type="checkbox" /></td>
              <td>{{ order.orderId }}</td>
              <td>{{ order.customerName }}</td>
              <td>{{ order.trackingId }}</td>
              <td>{{ order.orderDate }}</td>
              <td>{{ order.quantity }}</td>
              <td>{{ order.location }}</td>
              <td>{{ order.total }}</td>
              <td>
                <span
                  class="status-badge"
                  [ngClass]="'status-' + order.status.toLowerCase().replace(' ', '-')"
                >
              </span>
                  {{ order.status }}
              </td>
              <td>
                <div class="action-menu-wrapper">
                  <button class="action-btn" (click)="toggleRowMenu(i)">
                  <img src="/three dot.png" alt="more" width="16px" height="16px"/>
                  </button>
                  <div class="row-action-menu" *ngIf="openActionMenuIndex === i">
                    <button class="row-action-item" (click)="startEdit(order)">Update</button>
                    <button class="row-action-item danger" (click)="confirmAndDelete(order)">
                      Delete
                    </button>
                  </div>
                </div>
              </td>
            </tr>
            <tr *ngIf="filteredOrders.length === 0">
              <td colspan="10" class="no-results">
                <div class="no-results-content">
                  <p>No orders found matching "{{ searchText }}"</p>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </main>


  <app-order-form
    *ngIf="showOrderForm"
    [isEdit]="isEditing"
    [data]="isEditing ? editingOrderData : null"
    (closeModal)="closeOrderForm()"
    (submitOrder)="onSubmitFromForm($event)"
  ></app-order-form>
</div>
